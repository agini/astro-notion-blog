---
const props = Astro.props || {}
const notionCover = props.notionCover || ''
const slug = props.slug || ''
const date = props.date || ''

const proxyBase = import.meta.env.PUBLIC_NOTION_IMAGE_PROXY || ''

// Local cover path
const localCover = slug ? `/cover/${slug}.jpg` : ''
// Default cover path
const defaultCover = '/cover/default.webp'

// Cover image priority: Notion cover → Local → Default
let coverUrl = defaultCover

if (notionCover) {
  coverUrl = proxyBase
    ? `${proxyBase}?url=${encodeURIComponent(notionCover)}`
    : notionCover
} else if (slug && localCover) {
  coverUrl = localCover
}

// Format date → keep only YYYY-MM-DD
const shortDate = date ? date.split('T')[0] : ''
---

<!-- Header cover image -->
<div class="relative w-full h-[45vh] md:h-[55vh] overflow-hidden">

  <!-- Cover image (FIXED: object-cover で確実に表示) -->
  <img src={coverUrl} alt="" class="absolute inset-0 w-full h-full object-cover" />

  <!-- Dark overlay -->
  <div class="absolute inset-0 bg-black/40"></div>

  <!-- Date only -->
  {
    shortDate && (
      <div class="absolute bottom-8 left-6 md:left-12 text-white text-sm md:text-base drop-shadow-md">
        {shortDate}
      </div>
    )
  }
</div>

<!-- Title below cover
<header class="w-full py-4 px-4 md:px-8 bg-white">
  <h1 class="text-3xl md:text-4xl font-bold text-center">{title}</h1>
</header> -->
